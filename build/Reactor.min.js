var Reactor=Reactor||{};!function(t,e){var r=React.createClass({displayName:"SwitchView",render:function(){var t=this.props.else||React.DOM.span(null),e={};React.Children.forEach(this.props.children,function(t,r){e[r]=t,t.props.id&&(e[t.props.id]=t)});var r=null;return null!==this.props.show?r=this.props.show:this.props.else||(r=0),e[r]&&(t=e[r]),React.addons.cloneWithProps(t,this.props.clientProps)}}),n=React.createClass({displayName:"Animate",getInitialState:function(){return{show:0}},componentWillMount:function(){var t=this.props.children;t.length&&(this.timer=setInterval(function(){var e=this.state.show+1;t.length<=e&&(e=0),this.setState({show:e})}.bind(this),this.props.interval||1e3))},componentWillUnmount:function(){clearInterval(this.timer)},render:function(){return r({show:this.state.show},this.props.children)}}),o=Backbone.history.loadUrl;Backbone.history.loadUrl=function(t){return this.trigger("preroute",this.getFragment(t)),o.apply(this,arguments)};var i=React.createClass({displayName:"Router",getInitialState:function(){return{route:null,clientProps:{}}},_extractParameters:function(){return Backbone.Router.prototype._extractParameters.apply(this,arguments)},_routeToRegExp:function(){return Backbone.Router.prototype._routeToRegExp.apply(this,arguments)},hasContext:function(t){return t?"/*"==t.substring(t.length-2):!1},stripContext:function(t){return this.hasContext(t)&&(t=t.substring(0,t.length-2)),t.length>1&&"/"==t.substring(t.length-1)&&(t=t.substring(0,t.length-1)),t},isRouter:function(){return!0},getRoute:function(t){var e="";return this.isRouter()&&this.hasContext(this.props.route)&&(e+=this.stripContext(this.props.route)),e+=t.props.route,this.stripContext(e)},handleRoute:function(t){var e=!1;React.Children.forEach(this.props.children,function(r,n){if(!e){var o={},i=this.getRoute(r);if(_.isString(i)&&this.hasContext(r.props.route)&&(t=t.substring(0,i.length)),t=this.stripContext(t),!i)return;if(_.isRegExp(i)||(i=this._routeToRegExp(i)),i.test(t)){var s=this._extractParameters(i,this.getRoute(r)),a=this._extractParameters(i,t);if(a.length>0)for(var h in a){var u=s[h];u&&(u=u.substring(1))&&(o[u]=a[h])}}else if(""!==t||"/"!==this.getRoute(r))return;this.route=n,this.clientProps=o,e=!0}}.bind(this)),e||(this.route=null,this.clientProps={}),this.isMounted()&&this.forceUpdate()},componentDidMount:function(){Backbone.history.on("preroute",this.handleRoute,this),Backbone.History.started||Backbone.history.start(),Backbone.history.loadUrl()},componentWillUnmount:function(){Backbone.history.off("preroute",this.handleRoute,this)},render:function(){return r({show:this.route,clientProps:this.clientProps,"else":this.props.notFound||React.DOM.span(null)},this.props.children)}});if(t={SwitchView:r,Animate:n,Router:i},e)for(var s in t)e[s]=t[s]}(Reactor,window),"undefined"!=typeof module&&module&&module.exports&&(module.exports=Reactor),"undefined"!=typeof define&&define&&define.call&&define(["Reactor"],function(t){return t});